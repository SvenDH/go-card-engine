// Code generated by cmd/cgo; DO NOT EDIT.

//line /home/sven/go/pkg/mod/github.com/ebitengine/purego@v0.8.0/internal/cgo/dlfcn_cgo_unix.go:1:1
// SPDX-License-Identifier: Apache-2.0
// SPDX-FileCopyrightText: 2024 The Ebitengine Authors

//go:build freebsd || linux

package cgo; import _cgo_unsafe "unsafe"

/*
 #cgo LDFLAGS: -ldl

#include <dlfcn.h>
#include <stdlib.h>
*/
import _ "unsafe"

import (
	"errors"
	"unsafe"
)

func Dlopen(filename string, flag int) (uintptr, error) {
	cfilename := ( /*line :22:15*/_Cfunc_CString /*line :22:23*/)(filename)
	defer func() func() { _cgo0 := /*line :23:15*/unsafe.Pointer(cfilename); return func() { _cgoCheckPointer(_cgo0, nil); /*line :23:41*/_Cfunc_free(_cgo0); }}()()
	handle := ( /*line :24:12*/_Cfunc_dlopen /*line :24:19*/)(cfilename,  /*line :24:32*/_Ctype_int /*line :24:37*/(flag))
	if handle == nil {
		return 0, errors.New(( /*line :26:24*/_Cfunc_GoString /*line :26:33*/)(( /*line :26:35*/_Cfunc_dlerror /*line :26:43*/)()))
	}
	return uintptr(handle), nil
}

func Dlsym(handle uintptr, symbol string) (uintptr, error) {
	csymbol := ( /*line :32:13*/_Cfunc_CString /*line :32:21*/)(symbol)
	defer func() func() { _cgo0 := /*line :33:15*/unsafe.Pointer(csymbol); return func() { _cgoCheckPointer(_cgo0, nil); /*line :33:39*/_Cfunc_free(_cgo0); }}()()
	symbolAddr := func() _cgo_unsafe.Pointer{ _cgo0 := /*line :34:24*/*(*unsafe.Pointer)(unsafe.Pointer(&handle)); var _cgo1 *_Ctype_char = /*line :34:69*/csymbol; _cgoCheckPointer(_cgo0, nil); return /*line :34:77*/_Cfunc_dlsym(_cgo0, _cgo1); }()
	if symbolAddr == nil {
		return 0, errors.New(( /*line :36:24*/_Cfunc_GoString /*line :36:33*/)(( /*line :36:35*/_Cfunc_dlerror /*line :36:43*/)()))
	}
	return uintptr(symbolAddr), nil
}

func Dlclose(handle uintptr) error {
	result := func() _Ctype_int{ _cgo0 := /*line :42:22*/*(*unsafe.Pointer)(unsafe.Pointer(&handle)); _cgoCheckPointer(_cgo0, nil); return /*line :42:66*/_Cfunc_dlclose(_cgo0); }()
	if result != 0 {
		return errors.New(( /*line :44:21*/_Cfunc_GoString /*line :44:30*/)(( /*line :44:32*/_Cfunc_dlerror /*line :44:40*/)()))
	}
	return nil
}

// all that is needed is to assign each dl function because then its
// symbol will then be made available to the linker and linked to inside dlfcn.go
var (
	_ = ( /*line :52:6*/_Cgo_ptr(_Cfpvar_fp_dlopen) /*line :52:13*/)
	_ = ( /*line :53:6*/_Cgo_ptr(_Cfpvar_fp_dlsym) /*line :53:12*/)
	_ = ( /*line :54:6*/_Cgo_ptr(_Cfpvar_fp_dlerror) /*line :54:14*/)
	_ = ( /*line :55:6*/_Cgo_ptr(_Cfpvar_fp_dlclose) /*line :55:14*/)
)
